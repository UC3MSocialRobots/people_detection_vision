<launch>
<arg name="robot" value="datagrabber"/>
<arg name="viewer" default="false"/>
<arg name="input_use_rlpd" default="true"/>
<arg name="input_use_dgait" default="false"/>
<arg name="rate" value=".5"/> <!-- Hz -->

<!-- the detectors and their GUIs - launch them last to ensure mcp_server alive -->
<include file="$(find people_detection_vision)/launch/all_pplp.launch">
  <arg name="robot" value="$(arg robot)" />
  <arg name="eventgui" value="false"/>
</include>

<!-- input data and truth PPL publisher -->
<include  if="$(arg input_use_rlpd)"
          file="$(find people_utils)/launch/database_player.launch">
  <arg name="display" value="false" />
  <arg name="rate" value="$(arg rate)"/>
</include>
<group ns="$(arg robot)">
  <node if="$(arg input_use_dgait)"
    pkg="people_detection_vision" type="dgait2ppl.exe"
    name="dgait2ppl"  output="screen" required="true"
    args="/home/user/Downloads/0datasets/DGaitDB/*.oni" />
  <!--
    args="/home/user/Downloads/0datasets/DGaitDB/1.oni" />
    args="/media/disk/Datasets/DGaitDB/1.oni" />
  -->
</group>

<group ns="$(arg robot)">
  <arg name="ppl_topics" default="nite_user_mask_pplp/ppl;hog_pplp/ppl;tabletop_pplp/ppl;ppm_pplp/ppl;face_detector_pplp/ppl;artoolkit_pplp/ppl;leg_pplp/ppl"/>

  <!-- PPL benchmarker -->
  <node pkg="people_detection_vision" type="pplp_benchmarker.exe"
    name="pplp_benchmarker"  output="screen"
    args="_ppl_topics:=$(arg ppl_topics)
          _errors_display_timeout:=15
          _results_filename:=$(find people_detection_vision)/pplp_benchmarker_results.txt" />

  <!-- PPL viewer -->
  <node if="$(arg viewer)" pkg="people_utils" type="ppl_viewer.exe"
    name="ppl_viewer"  output="screen"
    args="_ppl_topics:='ground_truth_ppl;$(arg ppl_topics)'
          _width:=480 _height:=800
          _reprojection_mode:=xz
          _xmin:=-3 _xmax:=3 _ymin:=0 _ymax:=4" />

<!-- publish eventS to start PPLP -->
  <node pkg="rostopic" type="rostopic" name="artoolkit_pplp_starter" output="screen"
        args="pub ARTOOLKIT_PPLP_START std_msgs/Int16 '{data: 0}' --latch  -1"/>
  <node pkg="rostopic" type="rostopic" name="FACE_DETECTOR_pplp_starter" output="screen"
        args="pub FACE_DETECTOR_PPLP_START std_msgs/Int16 '{data: 0}' --latch  -1"/>
  <node pkg="rostopic" type="rostopic" name="LEG_pplp_starter" output="screen"
        args="pub LEG_PPLP_START std_msgs/Int16 '{data: 0}' --latch  -1"/>
  <node pkg="rostopic" type="rostopic" name="HOG_pplp_starter" output="screen"
        args="pub HOG_PPLP_START std_msgs/Int16 '{data: 0}' --latch  -1"/>
  <node pkg="rostopic" type="rostopic" name="NITE_USER_MASK_pplp_starter" output="screen"
        args="pub NITE_USER_MASK_PPLP_START std_msgs/Int16 '{data: 0}' --latch  -1"/>
  <node pkg="rostopic" type="rostopic" name="PPM_pplp_starter" output="screen"
        args="pub PPM_PPLP_START std_msgs/Int16 '{data: 0}' --latch  -1"/>
  <node pkg="rostopic" type="rostopic" name="TABLETOP_pplp_starter" output="screen"
        args="pub TABLETOP_PPLP_START std_msgs/Int16 '{data: 0}' --latch  -1"/>
</group>
</launch>
